import matplotlib.pyplot as plt
from matplotlib.patches import Rectangle, Circle
import numpy as np
from copy import copy
from scipy.spatial import distance
small=[[1.7440881695038628, 0.5606633638258729, 9.830758518520335], [-0.3000806976569647, 0.8444815244653727, 9.959759160227238], [-2.386215239147228, 0.8068309885506987, 9.677551373584945], [-1.2095732038139728, -0.9488833689139584, 9.881121040489978], [0.8036333259466769, -1.4785650758940134, 9.857383973132752], [3.6158233688293926, 0.03422264641824833, 9.323339003591975], [2.8745909587092897, 2.1653241563779297, 9.329957026584474], [1.1149758579284137, 3.1693540294259237, 9.41870606147142], [-0.9141923789981037, 2.7863053882271775, 9.560374186072321], [-2.9232947107805294, 2.7436131233622163, 9.161164503666399], [-4.253550685691067, 1.2151514890453476, 8.96831720128854], [-3.32799049803117, -0.9454700070280044, 9.382460536065405], [-2.8261156411380015, -2.9400315870577214, 9.130678214131631], [-0.798740757427192, -2.9008891150952616, 9.53660608100945], [1.0124974425560986, -3.767499490584987, 9.207648805056543], [2.57965344425892, -2.38785601331942, 9.361812418927084], [5.403458134680852, -0.028538606109979388, 8.414382076820177], [4.751513283735442, 1.8708215096761074, 8.597857197780087], [3.533939048606129, 4.004218392431264, 8.454437288575269], [1.7073724565247401, 5.005485356780771, 8.487048700093217], [-0.19226478159111451, 5.657176975804148, 8.243748111034881], [-1.7586511426633074, 4.469370482523908, 8.77108166923288], [-3.9140864082024116, 4.199334306900001, 8.188132813286423], [-5.3394326310188465, 2.802222642069475, 7.977343382548122], [-6.164881944516103, 0.9519221578312798, 7.815886054415661], [-5.148222575849997, -0.6404867248521722, 8.54901053133031], [-4.775625960598631, -2.6519982651355583, 8.376174657095826], [-3.8277025048905613, -4.420628060146578, 8.112135420954164], [-1.7103859807938948, -4.556216117940331, 8.735872851829086], [0.935506885244116, -5.550755971097936, 8.26522443839134], [2.7193686420460077, -4.590622279061484, 8.457613214119053], [4.48567860502033, -3.6927801060325156, 8.138922689210984], [4.500560927551335, -1.788163841457475, 8.749138324058107], [6.96466658735047, -0.25381270758108676, 7.171401427650967], [6.432889388861821, 1.6908702386371295, 7.467187686589925], [5.455435315692176, 3.477851809212698, 7.6251408058772645], [4.733755982255205, 5.416485142681769, 6.946455427019649], [2.788379585481702, 6.219067242567014, 7.317659593046044], [0.8678724332100654, 6.964677698439743, 7.123205879134065], [-1.2324716650730108, 6.95392616266557, 7.079825175736152], [-2.7820666218056904, 5.800784267353601, 7.655782598497531], [-4.6923451803947165, 5.6451092446922715, 6.790775973592146], [-6.117626700491703, 4.2044518234641215, 6.700539412435407], [-7.045154474663653, 2.4132378549186657, 6.67398542729262], [-7.547972520930472, 0.2156072187248278, 6.5560372444421215], [-6.472205542646882, -1.7232225298537, 7.425702628461201], [-5.903368824707415, -3.770517184581961, 7.1367665423667], [-4.866653133989525, -5.519769862285803, 6.771102416950384], [-2.9142928195171596, -6.100019793493554, 7.368626458241562], [-0.9113526168464291, -6.1864773027878615, 7.803648825380202], [0.8035878568297514, -7.136928489812107, 6.958340196315788], [2.611647143890808, -6.282118050533794, 7.329003478984336], [4.442078005082996, -5.483335554459578, 7.085264581789261], [6.184689904191752, -3.907541480634039, 6.81767778397549], [6.156650007579229, -2.0395760270004706, 7.611556366096205], [8.25506866480181, -0.10723380724775133, 5.642901935173995], [7.818375045963783, 1.8607906719809564, 5.950669686322664], [6.946162102934192, 3.662564507035485, 6.191643826284324], [6.2483605772005335, 5.445556556901981, 5.594989176295879], [4.305294496824101, 6.97298546526426, 5.730786420451339], [2.4344569851078997, 7.6857223539885275, 5.9163410217008625], [0.5313234686734882, 8.25857471837857, 5.6137010066973705], [-1.472959442424433, 8.214140331041289, 5.509835669322055], [-3.117858275208984, 7.247512775151421, 6.144307800698775], [-5.028149265058512, 6.871787203909074, 5.243687213448475], [-6.5636784082689505, 5.5654990052123265, 5.0934611587607685], [-7.6180975008636045, 3.8315083918713646, 5.223421666910972], [-8.434136170088639, 1.9843705349726923, 4.992756818065023], [-8.705572561753048, -0.04722618482627102, 4.920444701398366], [-7.907195167119068, -1.6530715734486043, 5.8943718038604445], [-7.365985523744915, -3.617938438865894, 5.714260994788124], [-6.402672426330812, -5.446939903162822, 5.416330076023404], [-4.971852190107163, -6.873028126408184, 5.2954858297731855], [-3.119317281995908, -7.492381460202373, 5.842437825861515], [-1.0028403260593233, -7.7286948457987386, 6.265906738928791], [0.7670911110517404, -8.394659494953206, 5.3797084671139395], [2.610653700867467, -7.673262046030691, 5.8570928648171465], [4.480666393730807, -7.014894416577165, 5.542101135162174], [5.991293231678855, -5.625040667732937, 5.697659422814753], [7.53488107730711, -3.852074833149499, 5.327953324744457], [7.617774518632133, -1.9580728579728515, 6.175391652854823], [9.216257034700536, 0.03540950275898809, 3.8806381482234644], [8.844950116676394, 1.9993592543647882, 4.215378987172106], [8.046403274579914, 3.9623807657840526, 4.422095997349472], [7.248434860900168, 5.734344921783461, 3.818046671441223], [5.739430279149278, 6.956102701044814, 4.321061823591682], [4.106724339519553, 8.240104670917509, 3.90326660779419], [2.119394141786941, 8.816518201369025, 4.216298765112346], [0.18258929640605567, 9.25575525269356, 3.7812241207145534], [-1.8973569124939118, 9.108207875216074, 3.6661404840054135], [-3.534089196005554, 8.22787936583136, 4.451091405038022], [-5.270956116336001, 7.770555769218017, 3.4402739218167957], [-6.837855395764819, 6.509928310833229, 3.29614425873959], [-8.045350293524729, 4.805937561334829, 3.489312655958565], [-8.948862141093015, 2.979145180476047, 3.3230348137445778], [-9.383014330338467, 0.9950376867450759, 3.3119393229073455], [-9.384929359787069, -1.1907130948192135, 3.241188553236715], [-8.600375749430391, -2.7435040651806624, 4.301944027175018], [-7.866281901747954, -4.728170997186144, 3.970643280829996], [-6.782364948014761, -6.408082185919803, 3.5966662912255307], [-5.180671749505352, -7.797724594586581, 3.5151289266336554], [-3.327887298663186, -8.553524763258014, 3.970186425311559], [-1.3941151435734684, -8.872168599778375, 4.397848030976713], [0.4660087266661092, -9.334791168814979, 3.5559119366605407], [2.314319001216678, -8.807298614002832, 4.132241363278681], [4.441214198014843, -8.165008082603133, 3.688937443001287], [5.964934407357179, -6.9039234295181044, 4.093335900616691], [7.332918326985117, -5.426730740699, 4.096205839275936], [8.557617452895192, -3.7370572465360508, 3.5779305004451945], [8.732602289352835, -1.8707628396645606, 4.499100316032067], [9.804410534884571, 0.0, 1.968129585023416], [9.47496313686327, 2.2296028317750367, 2.2921485047053323], [8.730018311781151, 4.174705270285959, 2.5216296679354855], [7.857689885240581, 5.911922046449371, 1.818209939499219], [6.28114682166803, 7.426847794971656, 2.3214492100785327], [4.687972629585185, 8.614956781568246, 1.9507517207403455], [2.8109996684373613, 9.291856937738793, 2.3999323975146702], [0.8754001489343152, 9.788313365633194, 1.8500259553347764], [-1.1250838925961222, 9.746616679578663, 1.9333001670665977], [-3.1573421339840158, 9.253426231766245, 2.0988791347358804], [-4.958772691329199, 8.535784277663309, 1.5971725520192424], [-6.619102949672601, 7.366480814615107, 1.386519581377425], [-7.962229036328426, 5.8166621129099365, 1.6641366041544363], [-8.986612557478695, 4.070331846588831, 1.6349903364885647], [-9.640984277635607, 2.110130093223505, 1.6120710741327715], [-9.868439642591595, -0.12682127266105062, 1.61177398704885], [-9.634871249552353, -2.206998225174124, 1.5160523865050857], [-8.910055138131584, -3.8472653885006283, 2.410283482476715], [-7.9053703271286935, -5.811471119557032, 1.9318186813227793], [-6.580061570668164, -7.327337282368896, 1.735775929267033], [-4.958283449531639, -8.523491300621947, 1.6629856530717841], [-3.109549067060083, -9.306500254428714, 1.9286673154963858], [-1.1858579949886465, -9.634788149248642, 2.400957753651531], [1.3301061025630738, -9.76198139774159, 1.7130490203352728], [3.167110447470024, -9.193017853266031, 2.3362007968191083], [5.035226678797281, -8.458703037220618, 1.7597827198955054], [6.632846607563858, -7.234677774006751, 1.914362396940909], [7.939997595057642, -5.685133005167783, 2.153067789000338], [9.114217440793617, -3.7921790939348283, 1.5970028683308828], [9.482831121796883, -1.9407371450290483, 2.5118625060669535], [9.999939263844723, 0.015777372481310507, -0.031077225330129923], [9.797552065213239, 1.9866343850595745, 0.24750222127233332], [9.184738992076108, 3.9271498283212036, 0.4669730970340097], [8.261996205123683, 5.627542726664629, -0.2649180365431522], [7.041417507084444, 7.091278171882978, 0.36361157833695223], [5.500621827425128, 8.350078603434618, 0.13909287586942817], [3.5560353387350956, 9.336293966777157, 0.43385208952779936], [1.6559345622967931, 9.857171355941377, -0.3066815693837969], [-0.34959941303267605, 9.993347513711056, -0.10385432399407492], [-2.3162426646017265, 9.72318399038515, 0.30775478517258725], [-4.23060354731158, 9.057011714353532, -0.2693184574766096], [-6.030414174019797, 7.958573373244208, -0.5433366842662609], [-7.509694084756631, 6.598938749327551, -0.2418721480340891], [-8.69154426608648, 4.934443500060565, -0.3291285696643482], [-9.515673971617073, 3.070617368256923, -0.1525052249868103], [-9.937397530814165, 1.0958382094441927, -0.21741419753697797], [-9.934523942271134, -1.10901777190272, -0.2744332743046022], [-9.495388814579869, -3.1240088425354173, -0.27957112102655135], [-8.715900961853906, -4.892998907734135, 0.302707964987231], [-7.4220109640214975, -6.698601339634766, -0.2061391340527537], [-5.936950531795579, -8.046816355940116, -0.036944780237562494], [-4.213376263649992, -9.06821335510469, -0.12233972049888227], [-2.3246707461846583, -9.725271529007381, 0.12247289051747401], [-0.34264963023381356, -9.978932617080211, 0.5509038524763841], [1.5140570371686741, -9.877615054924611, -0.37463597655150793], [3.5322870535619724, -9.350322436473185, 0.3072759431271327], [5.541553414303124, -8.32196556313838, -0.18993399475682882], [7.1176172409949245, -7.018669956137597, -0.27892088036443496], [8.349786852231755, -5.499489394017849, 0.1915096012811996], [9.232642903983752, -3.8066612253824808, -0.5173348264789788], [9.768487667428015, -2.078861631635623, 0.5049584218725668], [9.792847759407065, -0.08952983226217973, -2.0228982105412916], [9.558268600351388, 2.1094758713442823, -2.0468543943702917], [9.044371562787429, 3.979843102064839, -1.5362916120284649], [7.831355429741533, 5.807742753386172, -2.222610232035343], [6.614758147441267, 7.31891836125464, -1.6365844531062457], [4.990542125731072, 8.470863776123256, -1.8272810888493445], [3.1544955149988536, 9.346059759400386, -1.643266569844619], [1.270346724954303, 9.655647040329846, -2.2703963158372473], [-0.7842468960399895, 9.74464436366217, -2.1040111767285685], [-2.7310014561242832, 9.474292383224828, -1.667157726136024], [-4.8918710646652945, 8.457714370758795, -2.129944860636212], [-6.537924117397397, 7.166895218481752, -2.4271714324408307], [-7.940950228636666, 5.721231905712521, -2.0515396528881293], [-8.931215566757515, 3.9511352055127484, -2.149864899910221], [-9.527312187571761, 2.036051645251786, -2.2549536976208855], [-9.783426692004165, 0.010345036094585319, -2.0698925436864157], [-9.566100413748437, -2.1092848407323475, -2.010134407132689], [-8.846609191242594, -4.319726972481627, -1.7542704183325895], [-7.754880833852988, -5.974527664295107, -2.0412845076843205], [-6.36001061377556, -7.458248834172077, -1.981108104125832], [-4.697251487319634, -8.542156635169677, -2.228763891734637], [-2.904266426103855, -9.399466191960885, -1.7931179081115378], [-0.9534611434870343, -9.85261235787026, -1.4201906820573855], [0.8768479959794357, -9.688229069564978, -2.3171868909483737], [3.303338383924893, -9.27598610289892, -1.7447169799467783], [5.038247787485551, -8.362056709565518, -2.166117914128234], [6.633064906739794, -7.137470805626576, -2.2492132939775513], [7.982133814690982, -5.658635729659236, -2.065279991524311], [8.891778894027746, -3.838231840839182, -2.490832076975683], [9.62729102000415, -2.1136906223487224, -1.687477279592972], [9.189123344228852, -0.026433844039244283, -3.944529555781993], [8.971156325877676, 1.965074016458162, -3.956872285847241], [8.491781010430248, 3.8778729211848786, -3.584934710428807], [7.301477083519097, 5.415514686737945, -4.1666093021269806], [6.198236634462901, 6.988384431919292, -3.5699223597874057], [4.43080884738922, 8.123337784147706, -3.7920068832394844], [2.535597592914502, 8.879693945491546, -3.8368972205685954], [0.5665564366859572, 9.082066609894875, -4.146695057209094], [-1.486511474374304, 9.090531473636174, -3.8926239432269414], [-3.409609957382455, 8.74162763204144, -3.458107326450116], [-4.924589879162622, 7.635426882061446, -4.177160620654002], [-6.466706968561125, 6.310671651474853, -4.284521477368813], [-7.83026687503586, 4.866996169178125, -3.872888967543685], [-8.703471857823539, 2.989326757126848, -3.9132471375060334], [-9.109014324798537, 1.0019381536748004, -4.002746303080643], [-9.21244039257285, -1.0207946639368246, -3.753521049277637], [-8.802351786736937, -3.034489598164926, -3.648352491352491], [-7.798742192469105, -4.775171720266239, -4.046894520168735], [-6.576526184323709, -6.527982009378344, -3.7596215543771576], [-4.943752464529982, -7.576088004426441, -4.261713519071817], [-3.289217933429702, -8.678220327607615, -3.724182773697127], [-1.3835700168862404, -9.323351394295267, -3.340786252795276], [0.4877623882741109, -9.017850897463193, -4.29423486126544], [2.393690255472183, -9.039288353444034, -3.5442224851366975], [4.1504363588778155, -8.182765891582827, -3.976961201024444], [5.801702149265148, -7.030096507825896, -4.113149068763041], [7.219544133569919, -5.600051171180084, -4.064186189583438], [8.14228743417312, -3.8465706360639174, -4.348223738617567], [9.038052697314575, -2.041937783826513, -3.7608634018728213], [8.216949298942481, -0.16902881610221224, -5.696768687417083], [7.895119589894155, 1.8804693995802257, -5.842167534272869], [7.533357636210915, 3.8091638722355765, -5.360857517169989], [6.152509207297545, 5.321756510766341, -5.815972669660254], [4.996513532900348, 6.878935567036298, -5.264513081008223], [3.167249453077205, 7.7692971491187, -5.441190376257588], [1.1490981373317142, 8.041296053224961, -5.832420702861674], [-0.8811415643825594, 8.165907746242361, -5.704519280656034], [-2.9706159831267462, 7.962791632416774, -5.269666981841005], [-4.430460808972241, 6.742726934736866, -5.908185043118997], [-5.905874140124052, 5.386342182408858, -6.008990641947861], [-7.282106711345174, 3.975718244772406, -5.582525081248217], [-8.016667195307424, 2.0975596239145258, -5.597614733420418], [-8.236779792075458, 0.08508083265979928, -5.669940026911333], [-8.272676258152492, -1.949148510571405, -5.26912209115877], [-7.305505771134502, -3.6775090910106285, -5.753738985516694], [-6.3767408610736105, -5.426178180870038, -5.467519212601279], [-4.6939347207241315, -6.465205365641151, -6.013991720784568], [-3.1520849920295584, -7.710479602271932, -5.5328893451767565], [-1.2336385693323446, -8.45036138855975, -5.202838483269893], [0.728829875708781, -7.936694103383941, -6.039676623924902], [2.6091040548411804, -8.027870186047494, -5.361518097235254], [4.448461296431697, -6.9178818169247585, -5.6880667419793], [5.9845858645700645, -5.621349791216251, -5.7083411385779295], [6.992551869744949, -3.9111107084005488, -5.983931097160209], [8.032373596118653, -2.21800093895607, -5.528240791351791], [6.91246813213644, 0.19061064624746013, -7.223673020267131], [6.495975496480091, 2.193491257175218, -7.279484765684046], [5.621094476641086, 4.010573130042041, -7.233159755823168], [4.246520897027178, 5.833027342582379, -6.9240777213862845], [2.0932171301771287, 6.749645263169031, -7.0753608294780905], [0.03727612591196279, 6.9426433436403405, -7.197104549292269], [-2.09687921369064, 7.006975244197087, -6.819486453568281], [-3.4757250941441504, 5.6636378914949255, -7.472786689312064], [-4.97122711599957, 4.305634310260748, -7.533154329194114], [-6.397607437458553, 2.9399172020705557, -7.10123270433695], [-6.8524755259617764, 0.9480619214576276, -7.221132719953079], [-7.128633455590373, -1.0227574992207729, -6.938051034233268], [-6.21413752515747, -2.803456223283452, -7.3160869337756695], [-5.21309608541629, -4.671462304295145, -7.1415032831867284], [-2.9290369377388754, -6.416624293126431, -7.088559465661621], [-1.0209562436595663, -7.251357065787188, -6.8099536748050475], [0.5873566304777899, -6.404117940352364, -7.65782512170987], [2.8047177981132445, -6.71080817989627, -6.862842825359191], [4.382394233031537, -5.368613619979384, -7.2092030478870415], [5.644780080175178, -3.5538528647560423, -7.4502743346888085], [6.751061563955682, -1.8209447847619362, -7.1489389317946035], [5.387737148351739, -0.3914990462343168, -8.415403550458425], [5.0084328911443885, 1.5805250124918824, -8.509849626156187], [3.999567047556832, 3.590409522457102, -8.432818205863736], [2.7382560978701456, 5.155053297402426, -8.119567663577744], [0.7698993909674574, 5.449817147246359, -8.349056712549476], [-1.2535721928810528, 5.684008328700938, -8.13145780758246], [-2.5905798686673434, 4.276722796796148, -8.660169632485246], [-4.086995324041142, 2.8592814028902347, -8.667235953887023], [-5.177754272074131, 1.1241857830243673, -8.480982668492134], [-5.58849919367479, -0.971144395683865, -8.235627196821627], [-4.457366494430767, -2.834149526212342, -8.49114128944963], [-3.3871540139038254, -4.621154038069823, -8.195860116090694], [-1.3072536005038409, -5.716651755365533, -8.100060538776603], [0.2765205658754823, -4.681774825147105, -8.832016806101917], [2.160765726988388, -5.252326559730567, -8.230683883069572], [3.8332398199754065, -3.8160345219999043, -8.410954345938391], [4.033852810379242, -1.86556292651199, -8.958108420387617], [3.674844740137755, 0.14233785141461439, -9.299207281910462], [3.0426624063611336, 2.0521814632332984, -9.30219096357833], [1.744595286911346, 3.602986984495694, -9.163780446651991], [-0.5864892824599044, 4.061344141197172, -9.119293508179409], [-1.8309017856772745, 2.5263698381307695, -9.50080281303569], [-3.3741482055401955, 1.0424475134433722, -9.355662834282006], [-3.8084370870507147, -0.9714614257555619, -9.195219934957816], [-2.5632931342394625, -3.0381981392096837, -9.17599478938734], [-0.5409890826710115, -2.8739509630531574, -9.562830996854258], [1.733771207033916, -3.2888143987117195, -9.28319649972393], [2.201214534805444, -1.377527952106747, -9.6569700896775], [1.5893126000606803, 0.6823908205157204, -9.849285670918691], [0.3050175417956351, 2.241556856174185, -9.740759064864271], [-1.0351191331393061, 0.6896967267832941, -9.922340792639272], [-1.8769356038974867, -1.1588247903760658, -9.753678170004985], [0.25171867138095, -1.0212258331314346, -9.944532945705557]]



overlap = 0
nums = []
list = []

def printoverlap():
    ok = 0
    lens=len(small)
    for id in range(lens):
        i=small[id]
        for j in small[id+1:]:

            if ((j[1] - i[1]) ** 2 + (j[2] - i[2]) ** 2 + (j[0] - i[0]) ** 2) >= 4:
                ok += 1
            else:

                print(str(i) + " " + str(j) + " " + str(((j[1] - i[1]) ** 2 + (j[2] - i[2]) ** 2 + (j[0] - i[0]) ** 2)) )
    print(ok)
# output file
def writefile(list):
    f = open("datafile.xyz", "w")
    f.write(str(len(list)) + '\n' + '\n')
    for n in range(len(list)):
        f.write(str(1) + " " + str(list[n][0]) + " " + str(list[n][1]) + " " + str(list[n][2]) + "\n")

def readdata(data):
        with open('datafile.xyz', "r") as infile:
            natoms = int(infile.readline())
            infile.readline()
            positionlist = []
            for ii in range(natoms):
                line = infile.readline()
                sline = line.split()
                #  print(line)
                #  print(sline)
                positionlist.append([float(sline[1]), float(sline[2]), float(sline[3])])
                # print(positionlist)
                # exit()
        data = positionlist

# random point on sphere
def random(x0, y0, z0, radius):
    u = np.random.uniform()
    v = np.random.uniform()
    theta = 2 * np.pi * u
    phi = np.arccos(2 * v - 1)
    x = x0 + (radius * np.sin(phi) * np.cos(theta))
    y = y0 + (radius * np.sin(phi) * np.sin(theta))
    z = z0 + (radius * np.cos(phi))
    return [x, y, z]


# rotate 1 ball
def rotate(random1, random2, list):
    theta = np.arctan(list[1] / list[0])
    phi = np.arccos(list[2] / 10)
    theta += random1
    phi += random2
    x = (10 * np.sin(phi) * np.cos(theta))
    y = (10 * np.sin(phi) * np.sin(theta))
    z = (10 * np.cos(phi))
    return [x, y, z]


# main
def num():
    small.append(random(0, 0, 0, 10))
    for i in range(5000):
        new1 = random(0, 0, 0, 10)
        if check(new1):
            small.append(new1)
    print(len(small))


# number of no overlap pair
def numberofok():
    ok = 0
    for i in small:
        for j in small:
            if ((j[1] - i[1]) ** 2 + (j[2] - i[2]) ** 2 + (j[0] - i[0]) ** 2) >= 4:
                ok += 1
    print(ok)
    return(ok)



# check whether a pair overlap    new is not in the list
def check(new):
    ok = 0
    for j in small:
        if distance.euclidean(np.asarray(j), np.asarray(new)) >= 2:
            ok += 1
    if ok == len(small):
        return "true"


# shift one ball
def shift(l,stepsize):
    l[0] += np.random.uniform(np.negative(stepsize), stepsize)
    l[1] += np.random.uniform(np.negative(stepsize), stepsize)
    l[2] += np.random.uniform(np.negative(stepsize), stepsize)
    mag = distance.euclidean(np.asarray(l), (0, 0, 0))
    l[0] *= (10. / float(mag))
    l[1] *= (10. / float(mag))
    l[2] *= (10. / float(mag))


# try to add one
def addone(stepsize):
    for i in range(10):
        for s in range(len(small)):
            temp=[ss for ss in small[s]]
            shift(small[s],stepsize)
            shift(small[s],stepsize)
            shift(small[s],stepsize)
            new3=[ss for ss in small[s]]
            small[s]=[100,0,0]
            if check(new3):
                small[s]=[ss for ss in new3]
            else:
                small[s]=[ss for ss in temp]
        print("o")

        """for i in range(10):
            new4 = random(0, 0, 0, 10)
            if check(new4):
                small.append(new4)
                print("yeah")
        print("o")"""




#readdata(small)
#small.append(new4)
printoverlap()
writefile(small)
s=0.05
while numberofok()<95790:
    print(len(small))
    addone(s)
    numberofok()
    print(small)
   # s=s*0.6
    print("stepsize*0.9")



"""for i in small:
    rotate(1.57, 1.57, i)
addone()
for i in small:
    rotate(1.57, 1.57, i)
addone()
for i in small:
    rotate(1.57, 1.57, i)
addone()
numberofok()
print(len(small))
print(small)"""

