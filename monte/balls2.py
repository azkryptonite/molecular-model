import matplotlib.pyplot as plt
from matplotlib.patches import Rectangle, Circle
import numpy as np
from copy import copy
from scipy.spatial import distance
small=[[1.5613484753609965, 0.2236662181387919, 9.874824776235341], [-0.12383669425965195, 1.4753480745369703, 9.88979335133525], [-2.208848657176446, 0.739175376705721, 9.72494767966192], [-1.1921900305379318, -0.9979124617553722, 9.878403395780076], [0.7786743209908816, -1.6572878412482295, 9.830923828058085], [3.553165897234987, -0.3355043395539139, 9.34143719910736], [2.9996514599252606, 1.944923557027606, 9.33913076663387], [1.337483106202465, 3.335055077049076, 9.332124440537223], [-0.7510100265763295, 3.452606512969418, 9.3549715235581], [-2.7812627076688505, 2.7960462776349737, 9.189488721591326], [-4.1466654372329845, 0.9537298715661137, 9.049616847344415], [-3.332864641803321, -0.919950780089343, 9.383267226378573], [-2.8319593687695623, -2.8592187859070735, 9.15450020852883], [-0.793131944578286, -3.010443009437049, 9.503061328089021], [1.212001861809512, -3.564725979636241, 9.264112487285368], [2.708051412606646, -2.1661045248243416, 9.379469533732422], [5.385604436608155, -0.05317488476957211, 8.425700996594664], [4.884242591574832, 1.8976561477354374, 8.517222284971096], [4.073250107220409, 3.790394123341072, 8.309124259136482], [2.3158187403125394, 5.020226759329281, 8.332725055282422], [0.23248610404880984, 5.55428107278025, 8.312395080599773], [-1.830796228248086, 4.934896439994568, 8.502645605760689], [-3.7974214375278224, 4.298529095179339, 8.191595573739026], [-5.019691060058817, 2.691061535128368, 8.219543142761532], [-5.948411601216115, 0.8570644590805457, 7.992611584175633], [-5.219125405683861, -0.942318657175793, 8.477780697097778], [-4.657531319288954, -3.0046743876883655, 8.323420801197788], [-3.3862456054955685, -4.722778635713901, 8.13810190752772], [-1.4529669247333379, -4.77299590210471, 8.666452401884094], [0.5083424486797579, -5.299820713073315, 8.464838354283522], [2.5637610222035225, -4.885111877395834, 8.34043232490715], [4.276805897428228, -3.8539713715143322, 8.176541810770068], [4.61429063240962, -1.8941029633738027, 8.667219618989437], [6.973649053531414, -0.02550248091575225, 7.167117168126078], [6.511989626651175, 1.9538207436182404, 7.333251366494575], [5.825433439244455, 3.828990186095057, 7.169599668023332], [4.708614758791195, 5.48360018067707, 6.910794173738078], [2.9063672643972995, 6.485303216937912, 7.035188093350065], [0.9290818590113835, 7.018184115717575, 7.062711845824198], [-1.1536800586841918, 6.942150383906951, 7.1046161310386795], [-3.045930018747555, 6.105252981534549, 7.3108273370635715], [-4.899800796181114, 5.40739852277408, 6.8375429339524905], [-6.18646251108778, 3.8459946238205047, 6.850985837998007], [-7.171595428808894, 2.0667613800091407, 6.6555778414492375], [-7.515761157893692, 0.02503215829078638, 6.5964162701081674], [-6.561766635780889, -1.932009447010636, 7.294556745561338], [-6.089680562573156, -3.9887134075968493, 6.85608897242997], [-4.771101671824212, -5.503453689502986, 6.851903846713859], [-2.9656482282036865, -6.440124278726124, 7.051930931391393], [-0.986447569940446, -6.431428120573161, 7.593658770425451], [0.9209777886922416, -6.915922068178808, 7.163925031685696], [2.964347968341851, -6.467310400385385, 7.02755557129608], [4.69986029843702, -5.473399037879614, 6.924826073434192], [5.946406519678489, -3.9083585669222325, 7.026021834231001], [6.297521907543454, -1.9454874947117453, 7.520392026479102], [8.264843275075597, -0.006707947576614819, 5.629593292758992], [7.91214400994712, 1.9611083990255804, 5.792411502399432], [7.311067969858218, 3.8647198369002527, 5.62247505306897], [6.201146234430765, 5.531656132930042, 5.562963761002098], [4.725477590561495, 6.90230466997376, 5.47978574252311], [2.937015728544448, 7.79931201437492, 5.526723325145701], [1.0079312765794222, 8.330769488914937, 5.438966286368847], [-1.0241712857951373, 8.273712422969837, 5.522386795521237], [-2.898155459394267, 7.538970190047933, 5.896153271986055], [-4.8288879616332645, 6.946224282465276, 5.332148654312171], [-6.463697790448617, 5.531046052874494, 5.256247752411517], [-7.536579433408236, 3.81621641033741, 5.351304771118855], [-8.396079046941868, 1.9283553147608665, 5.078119968801176], [-8.694934657644776, -0.07222598137044128, 4.938916349453879], [-8.000279322081663, -1.8220356633711607, 5.716267734289233], [-7.520439749734864, -3.851636541700771, 5.348633649937445], [-6.2923933969176185, -5.510065373325694, 5.4813287549739895], [-4.811612107707924, -6.956999765576129, 5.333717576581293], [-2.8833711544122282, -7.8445110296582214, 5.490884946115153], [-0.9644214566737935, -7.871754924574268, 6.091417377043534], [0.9405564658284699, -8.259736344893042, 5.558067024374678], [2.9249500361330054, -7.844117789252616, 5.4694134415361395], [4.705551805111577, -6.913286776352223, 5.483087465773703], [6.233461144568887, -5.479272364869548, 5.5786679871387586], [7.357504210809084, -3.811779348827374, 5.597988029978251], [7.732971161934121, -1.8955306462671773, 6.050464492727579], [9.220953032414771, 0.0, 3.8696285576267937], [9.005372274693523, 1.9822323325433806, 3.8696285576267937], [8.36871031816002, 3.8717776843100355, 3.8696285576267937], [7.328678250997739, 5.588312108176382, 3.880881713600914], [5.9489236675073, 7.0431331156258885, 3.8735749784592355], [4.258220357872319, 8.140105067309063, 3.950474512887162], [2.3788976121083483, 8.890085336457586, 3.912445381293779], [0.35250213883007775, 9.249578249986664, 3.7843155840249194], [-1.6655246962818817, 9.113763841717612, 3.7636865070666743], [-3.543181428641846, 8.373096363927061, 4.163787055568401], [-5.381576626364717, 7.652110629610116, 3.53324722129273], [-6.938853653045041, 6.37758329831096, 3.3434624649797686], [-8.107613078988212, 4.7491899969963205, 3.422251383789532], [-8.973206851621182, 2.915093292336348, 3.3141801241022337], [-9.37419627441642, 0.955969860256546, 3.3482183075478185], [-9.39947724514237, -1.0495044937021263, 3.247825093158476], [-8.7127648712627, -2.8542433758394026, 3.992621075129417], [-8.082558517932327, -4.731180593394525, 3.505449756719756], [-6.81750063118331, -6.302855916258288, 3.7142553012283703], [-5.352203263908766, -7.687237406087516, 3.50147130278876], [-3.5370171030853803, -8.593583908724215, 3.6932134539175707], [-1.5823428542590718, -8.8685567898003, 4.341070323971067], [0.3846709491574279, -9.208293583502133, 3.880638805777696], [2.4127466433275977, -8.944640142988941, 3.7645805008715345], [4.250945587654719, -8.153324280986297, 3.9310004807781613], [5.934147733237394, -7.061046405086306, 3.863614155856048], [7.314496778040228, -5.608741192524507, 3.8781644007594465], [8.36871031816002, -3.8717776843100387, 3.8696285576267937], [9.005372274693523, -1.9822323325433837, 3.8696285576267937], [9.804410534884571, 0.0, 1.968129585023416], [9.590160641306591, 2.0384515717793033, 1.968129585023416], [8.956774709007062, 3.9878130282959607, 1.968129585023416], [7.888640199768583, 5.821219236685682, 1.970472632907068], [6.534186431655243, 7.30834213724682, 1.9729528330183534], [4.851782837877515, 8.500688766488656, 2.049022642473916], [2.936046758300085, 9.339896792875185, 2.036162403030607], [0.9109763673495542, 9.769122536959081, 1.9324510125767147], [-1.0965558538099403, 9.752658526759658, 1.9191708938750869], [-3.1270284970365503, 9.22486700012788, 2.2635197389625277], [-5.034541562208893, 8.477253264650324, 1.6702000914162012], [-6.666290757234492, 7.289695978012503, 1.5559241910062078], [-7.998511419727856, 5.776998258563525, 1.627914674986708], [-9.057168800700099, 3.961221867207776, 1.5087791867532085], [-9.676028697016244, 2.0054337797116393, 1.5338526688406624], [-9.88268495957786, -0.004071384680169166, 1.5272594453989594], [-9.661815488806377, -2.0779061103454666, 1.5269668158968541], [-8.997462645005827, -3.9866757717266053, 1.775410443489838], [-8.013451164060584, -5.759444136195794, 1.6166025124488512], [-6.6116502098894365, -7.246170536635152, 1.943989211922133], [-4.84053791097509, -8.567723020719033, 1.7785710479635126], [-2.980957182906522, -9.355385118460578, 1.8949046305723092], [-1.0347471779335107, -9.653474044481005, 2.3957748538396038], [0.940331872376891, -9.772123694285085, 1.9029909283504687], [2.930418698940449, -9.375287124242318, 1.875270003737162], [4.841457094201689, -8.52019414810294, 1.9916287012484393], [6.48774011018657, -7.35279457063782, 1.961030408911443], [7.930625556975932, -5.763355622241065, 1.972032009532933], [8.956774709007059, -3.9878130282959683, 1.968129585023416], [9.590160641306591, -2.0384515717793086, 1.968129585023416], [9.99999369325759, 0.0, -0.011230975400286038], [9.795293234881923, 2.012983931348687, -0.011230975400286038], [9.189572320572102, 3.9435560640323892, -0.011230975400286038], [8.213749916382286, 5.703883878974294, -0.004583263810267421], [6.880041092284709, 7.257058324767707, -0.01179149666348167], [5.291415352190524, 8.485193316059558, 0.049172753641087585], [3.497717531892983, 9.368239347523735, -0.04542680482396999], [1.5062142682264394, 9.885905293164964, -0.013968277060831185], [-0.505979991762194, 9.986958972626498, -0.06807882939215594], [-2.4680259664680384, 9.685457510916107, 0.3174281541991246], [-4.30366930596884, 9.025621361608316, -0.12880039495814666], [-6.015648867927902, 7.984598015959167, -0.2411705233619611], [-7.494716867195446, 6.618905091487225, -0.1389765104633196], [-8.698762579909031, 4.925582398015785, -0.26489171133019285], [-9.5427283739029, 2.9767579757987193, -0.2743121131616902], [-9.946328261676193, 1.0023328611634355, -0.25667673523973394], [-9.938487781902523, -1.0845079738512247, -0.22428344483566426], [-9.512007721148214, -3.074796542582379, -0.25949052880631684], [-8.710570832656073, -4.910054312320459, -0.13161466234644006], [-7.460860545051871, -6.655147729351021, -0.21111283192223818], [-5.932987292693206, -8.04833533368893, 0.15479063678156502], [-4.229997787166242, -9.05881888734653, -0.211941234361118], [-2.341753392239139, -9.721833274869653, -0.046355426583067114], [-0.4029018523085827, -9.984671222454109, 0.3794873870144802], [1.5540119266980918, -9.87683254609215, -0.1822794232351826], [3.508153620797459, -9.364318796246454, -0.04890455143436784], [5.311201419158438, -8.472956598420366, 0.012081656101443043], [6.907951493753977, -7.23048805741896, -0.015767417797112382], [8.220654988771395, -5.693926076314863, -0.006114985657389509], [9.189572320572102, -3.943556064032391, -0.011230975400286038], [9.795293234881923, -2.012983931348689, -0.011230975400286038], [9.799965001132968, 0.0, -1.9901472248476746], [9.58581225313348, 2.03752729334042, -1.9901472248476746], [8.95271351184149, 3.9860048668211534, -1.9901472248476746], [7.934973549342467, 5.75160263433028, -1.988784027490261], [6.484377035762695, 7.349015238770511, -1.9861594795967927], [4.851968696211057, 8.52727729611636, -1.9349267908958336], [2.985111744789391, 9.334372178296393, -1.9896240620194348], [1.012988710117083, 9.746331123743868, -1.9957162873306635], [-0.9929725772179812, 9.736685633472266, -2.0520619717318103], [-3.033414304680975, 9.345556017903071, -1.8598334259800064], [-4.874900978524269, 8.487371581466046, -2.049356993719169], [-6.504500150644141, 7.308333435140594, -2.0687532939131326], [-7.905486737956799, 5.808154512674914, -1.9412935359917138], [-8.945991645707105, 3.950258515432146, -2.089184323173641], [-9.55417405030992, 2.01889328524768, -2.1544902225738634], [-9.78561943975657, -0.012262144220231487, -2.0594906700632176], [-9.595838813313378, -2.0117882854250557, -1.967888554653183], [-8.936540723315003, -4.025117005236092, -1.9841050866049876], [-7.862963061696785, -5.820788156788405, -2.071771494200981], [-6.5109914954790975, -7.342316600862082, -1.9228563853038816], [-4.788786368219023, -8.530369692806046, -2.073720816217977], [-2.92414803691264, -9.363941024022168, -1.9406098930116424], [-0.9879400056013548, -9.83313764809617, -1.527540028583896], [0.9884674291669099, -9.727677503082345, -2.0964786041125714], [2.9514938824533545, -9.346204330781866, -1.9842249038641526], [4.809506585906066, -8.548115207058622, -1.948941458068792], [6.447530161022316, -7.389020095442781, -1.9574822737001383], [7.844812669726396, -5.882714727165387, -1.9627994333837768], [8.952713511841486, -3.986004866821161, -1.9901472248476746], [9.58581225313348, -2.037527293340425, -1.9901472248476746], [9.212237835605876, 0.0, -3.8903308420019473], [8.996860834342897, 1.9803588228488467, -3.8903308420019473], [8.360800619758672, 3.8681182681520276, -3.8903308420019473], [7.333798660557006, 5.575008802341095, -3.8903308420019473], [5.963876426919474, 7.0212181211099445, -3.8903308420019473], [4.3150899599317585, 8.139123084059152, -3.8903308420019473], [2.464534682295665, 8.876451697583345, -3.8903308420019473], [0.4987405020489919, 9.198727295196024, -3.8903308420019473], [-1.4903742297632387, 9.090880628136421, -3.8903308420019473], [-3.409800719023725, 8.557954486693285, -3.8903308420019473], [-5.169788716383966, 7.62486790493563, -3.8903308420019473], [-6.706895549902617, 6.333249164744644, -3.8610240998934127], [-7.973627015042435, 4.788340071777305, -3.6732916549053316], [-8.637319567848863, 2.946756268757418, -4.088194977663617], [-9.170188869071618, 1.0265983916026464, -3.8540539497928448], [-9.204460643113663, -0.9748192760339655, -3.7851858142559163], [-8.813602257920763, -2.9563809417690545, -3.685135949502915], [-7.938930130720804, -4.755035746056342, -3.789857970064284], [-6.740527531465317, -6.3744620797073805, -3.732495384046808], [-5.140984964081408, -7.655907643250531, -3.867473562560832], [-3.3605009747887835, -8.60649460901415, -3.825608937601176], [-1.5236333398692652, -9.279721136965602, -3.4007818315488363], [0.41977837479403374, -9.174294933748438, -3.956778814219088], [2.4189290788685613, -8.871211916219604, -3.9306972980537966], [4.2902037796867365, -8.143499389794497, -3.908653120600276], [5.95064888062564, -7.02339687791172, -3.9066192794856147], [7.333798660557008, -5.575008802341093, -3.8903308420019473], [8.36080061975867, -3.8681182681520307, -3.8903308420019473], [8.996860834342897, -1.9803588228488498, -3.8903308420019473], [8.260063394494434, 0.0, -5.636608263746301], [8.02004096430483, 1.9767625583107746, -5.636608263746301], [7.313922904932604, 3.8386428619720716, -5.636608263746301], [6.177256111973792, 5.485610831885172, -5.634676630312207], [4.747724582827198, 6.882552832951554, -5.485396775735445], [2.9524721658075044, 7.793447466552581, -5.526760777907536], [0.9956406202708754, 8.199838232327119, -5.636608263746301], [-0.9956406202708726, 8.199838232327119, -5.636608263746301], [-2.9290588469688807, 7.723293439463521, -5.636608263746301], [-4.695232640543496, 6.78272537829848, -5.652382408662803], [-6.21936879225196, 5.451565661907134, -5.621377381023037], [-7.461049201459156, 3.893108646746526, -5.401522922105683], [-7.963743896120058, 1.9765641441458672, -5.7159406348463255], [-8.273554899654073, -0.006307912068909517, -5.616782845424544], [-8.211777098978022, -2.0062628693978457, -5.342436352037862], [-7.324872879225393, -3.8724330417055115, -5.599151689380784], [-6.206493145678559, -5.5478067450118695, -5.540873861824132], [-4.6310023805824185, -6.773702255690986, -5.715835433450373], [-2.8694192253017485, -7.737187289618485, -5.648217962759128], [-0.9789382257283707, -8.464312751455472, -5.234222921863005], [0.9096126011360055, -8.086371694308326, -5.812331523351337], [2.910048898077323, -7.75255959925587, -5.606196132029686], [4.722133109923637, -6.892893685265591, -5.494495020999534], [6.203147945389975, -5.542384117101782, -5.550039086898581], [7.3148731958536946, -3.8691475307315817, -5.614474820855009], [7.986487084111261, -1.9863311157873547, -5.680714105971095], [6.981212570438221, 0.31099648640962985, -7.153037972204273], [6.593197273130374, 2.284433909395369, -7.163177467520316], [5.70412997208429, 4.161183867444022, -7.081486431738274], [4.109735718361559, 5.7058994315934735, -7.110048101227195], [2.2995573079596454, 6.561315962459586, -7.187570453789126], [0.3336098737180712, 7.005256082097375, -7.128470500492765], [-1.6916829263053776, 6.921520089641997, -7.0164641042001445], [-3.5517061106731154, 5.993174312854123, -7.17406756025846], [-5.115922329396715, 4.697438689050296, -7.194540185598627], [-6.53383290142407, 2.9750187482473063, -6.961198967408226], [-6.8521341380661305, 0.7975969009058301, -7.23961994427982], [-7.164974371640159, -1.148487532692082, -6.88070626033335], [-6.310143778530342, -3.038620359424949, -7.137847841300838], [-5.152156874077046, -4.81790190328071, -7.088236790293108], [-3.221889549708539, -6.276653737193221, -7.086821967063748], [-1.336003290847935, -7.149081207570328, -6.8633616467739955], [0.6368723488452039, -6.7683795936466975, -7.333718789780759], [2.6612443414283526, -6.480947458634505, -7.135481665145984], [4.439376029924514, -5.562623755923383, -7.024895544772781], [5.881615721395665, -3.9129916792311783, -7.077788681791716], [6.54591454403559, -1.6338799089315492, -7.381154328787142], [5.417807729192086, -0.05727870893618946, -8.40500318613914], [5.01157581397158, 1.9142036850087074, -8.439190252216985], [4.1334121626016165, 3.788112452700936, -8.280405058917657], [2.3961919150019635, 4.91906136177864, -8.370250869928313], [0.3781564162080986, 5.368672172568002, -8.428188229291905], [-1.6885100015319274, 5.359432070667497, -8.27196602112384], [-3.3644346108583916, 4.190783407771996, -8.433143789738265], [-4.8988170984889114, 2.9057346914071136, -8.219385435584943], [-5.254240313406154, 0.9053568387721626, -8.460099746661742], [-5.646486818920582, -1.0626422683367207, -8.184618379209887], [-4.711764751185773, -2.8773531292258845, -8.337872144571259], [-3.4431450800458356, -4.6042157094738, -8.18205045562485], [-1.6530340404863277, -5.539553860668204, -8.1597071936283], [0.3729502011938358, -5.086653350182726, -8.60156182576771], [2.3590247314199315, -4.6972354233869575, -8.507113593565556], [4.18289742966777, -3.9387498344676213, -8.184718616688055], [4.905978685449222, -2.016666192905172, -8.477289107038363], [3.684964241326668, 0.4248313686498574, -9.286579394392474], [3.0302942124379433, 2.3284617219957697, -9.240973054568746], [1.3186500107581594, 3.471060164446282, -9.285090386416368], [-0.6816759993792684, 3.7759215434085633, -9.234594432344789], [-2.253144257740271, 2.4872628968204817, -9.420024640939758], [-3.452923789705889, 0.8308803606339259, -9.348099011499396], [-3.8045186699822504, -1.1515158200466349, -9.176036672002724], [-2.4252484815988895, -3.1834205208231716, -9.16427867265636], [-0.3361293260091512, -3.1684297961356074, -9.478822168558533], [1.6716794762792357, -3.029110763082239, -9.38242909451311], [2.806978964645557, -1.3759338602524216, -9.498824932813966], [1.6836215481979377, 0.5470943939568311, -9.842058026985239], [0.02509055335439963, 1.967264204662337, -9.804552106709751], [-1.4802623484526218, 0.6124647381191775, -9.87085155011026], [-1.6331625799611968, -1.3907207213826334, -9.767224573159535], [0.5320582780297921, -1.1194733608632073, -9.922887351124047]]



overlap = 0
nums = []
list = []

def printoverlap():
    ok = 0
    lens=len(small)
    for id in range(lens):
        i=small[id]
        for j in small[id+1:]:

            if ((j[1] - i[1]) ** 2 + (j[2] - i[2]) ** 2 + (j[0] - i[0]) ** 2) >= 4:
                ok += 1
            else:

                print(str(i) + " " + str(j) + " " + str(((j[1] - i[1]) ** 2 + (j[2] - i[2]) ** 2 + (j[0] - i[0]) ** 2)) )
    print(ok)
# output file
def writefile(list):
    f = open("datafile.xyz", "w")
    f.write(str(len(list)) + '\n' + '\n')
    for n in range(len(list)):
        f.write(str(1) + " " + str(list[n][0]) + " " + str(list[n][1]) + " " + str(list[n][2]) + "\n")

def readdata(data):
        with open('datafile.xyz', "r") as infile:
            natoms = int(infile.readline())
            infile.readline()
            positionlist = []
            for ii in range(natoms):
                line = infile.readline()
                sline = line.split()
                #  print(line)
                #  print(sline)
                positionlist.append([float(sline[1]), float(sline[2]), float(sline[3])])
                # print(positionlist)
                # exit()
        data = positionlist

# random point on sphere
def random(x0, y0, z0, radius):
    u = np.random.uniform()
    v = np.random.uniform()
    theta = 2 * np.pi * u
    phi = np.arccos(2 * v - 1)
    x = x0 + (radius * np.sin(phi) * np.cos(theta))
    y = y0 + (radius * np.sin(phi) * np.sin(theta))
    z = z0 + (radius * np.cos(phi))
    return [x, y, z]


# rotate 1 ball
def rotate(random1, random2, list):
    theta = np.arctan(list[1] / list[0])
    phi = np.arccos(list[2] / 10)
    theta += random1
    phi += random2
    x = (10 * np.sin(phi) * np.cos(theta))
    y = (10 * np.sin(phi) * np.sin(theta))
    z = (10 * np.cos(phi))
    return [x, y, z]


# main
def num():
    small.append(random(0, 0, 0, 10))
    for i in range(5000):
        new1 = random(0, 0, 0, 10)
        if check(new1):
            small.append(new1)
    print(len(small))


# number of no overlap pair
def numberofok(a_cutoff):
    ok = 0
    for i in small:
        for j in small:
            if distance.euclidean(np.asarray(j), np.asarray(i)) >= a_cutoff:
                ok += 1
    print(ok)
    return(ok)



# check whether a pair overlap    new is not in the list
def check(new, a_cutoff):
    ok = 0
    for j in small:
        if distance.euclidean(np.asarray(j), np.asarray(new)) >= a_cutoff:
            ok += 1
    if ok == len(small):
        return "true"


# shift one ball
def shift(l,stepsize):
    l[0] += np.random.uniform(np.negative(stepsize), stepsize)
    l[1] += np.random.uniform(np.negative(stepsize), stepsize)
    l[2] += np.random.uniform(np.negative(stepsize), stepsize)
    mag = distance.euclidean(np.asarray(l), (0, 0, 0))
    l[0] *= (10. / float(mag))
    l[1] *= (10. / float(mag))
    l[2] *= (10. / float(mag))


# try to add one
def addone(stepsize,a_cutoff):
    for i in range(10):
        for s in range(len(small)):
            temp=[ss for ss in small[s]]
            shift(small[s],stepsize)
            shift(small[s],stepsize)
            shift(small[s],stepsize)
            new3=[ss for ss in small[s]]
            small[s]=[100,0,0]
            if check(new3,a_cutoff=a_cutoff):
                small[s]=[ss for ss in new3]
            else:
                small[s]=[ss for ss in temp]
        print("o")

        """for i in range(10):
            new4 = random(0, 0, 0, 10)
            if check(new4):
                small.append(new4)
                print("yeah")
        print("o")"""




#readdata(small)
#small.append(new4)

s=3
a_cutoff=2

for istep in range(10):
    if (numberofok(a_cutoff)==95790):
        a_cutoff+=2-0.1**(s)
        print ("new a_cutoff= " + str(a_cutoff))
    print(len(small))
    addone(s,a_cutoff)
    numberofok()
    print(small)
    s=s+1
    print("stepsize*0.9")



"""for i in small:
    rotate(1.57, 1.57, i)
addone()
for i in small:
    rotate(1.57, 1.57, i)
addone()
for i in small:
    rotate(1.57, 1.57, i)
addone()
numberofok()
print(len(small))
print(small)"""
#writefile(small)
